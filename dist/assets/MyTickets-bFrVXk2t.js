import{b as T,g as j,r as x,d as D,j as t,s as k,e as v,f as w,T as S,a8 as M,l as P,aC as R,a as g,t as f,S as m,at as z,aD as A,p as E}from"./index-BPKDHole.js";import{D as L,c as F,u as O,M as N}from"./index.esm-BLzOZQ4J.js";import{a as B,b as I,c as U}from"./DatePicker-CIMZADdp.js";import{S as H}from"./Selector-DjhxAGHy.js";import"./ExpandMore-CbX2L_R1.js";import"./Search-CIZ8ZmsB.js";import"./Checkbox-B9QuT8UR.js";import"./TableContainer-DH-3o7LA.js";import"./Menu-C5l8RJF2.js";import"./List-DH4347GI.js";import"./TextField-B77SMJ87.js";import"./Select-5_MAovsi.js";import"./FormControl-R2PLJ0Ur.js";import"./MenuItem-4qhA7_ZE.js";import"./listItemTextClasses-9LBcFKLv.js";import"./dividerClasses-BwGHlKnn.js";import"./KeyboardArrowRight-BJxTiFRg.js";import"./ListItemIcon-BG5aJMSs.js";import"./TableRow-Dmxg8gfN.js";import"./Divider-B03dux0C.js";import"./Skeleton-DYZ3hU44.js";import"./ListItem-CdFJn0sL.js";function G(e){return T("MuiDialogContentText",e)}j("MuiDialogContentText",["root"]);const Q=e=>{const{classes:s}=e,a=w({root:["root"]},G,s);return{...s,...a}},V=k(S,{shouldForwardProp:e=>M(e)||e==="classes",name:"MuiDialogContentText",slot:"Root",overridesResolver:(e,s)=>s.root})({}),W=x.forwardRef(function(s,r){const a=D({props:s,name:"MuiDialogContentText"}),{children:i,className:c,...l}=a,n=Q(l);return t.jsx(V,{component:"p",variant:"body1",color:"textSecondary",ref:r,ownerState:l,className:v(n.root,c),...a,classes:n})});function _({btnName:e,btnSx:s,ticketId:r}){const a=P(),[i,c]=x.useState(!1),l=()=>{c(!0)},n=()=>{c(!1)},[h,{isLoading:C}]=R(),b=async()=>{var d,p;try{const o=await h({ticketId:r}).unwrap();o!=null&&o.status&&(a(f({open:!0,message:o==null?void 0:o.message,severity:"success"})),n())}catch(o){(d=o==null?void 0:o.data)!=null&&d.status||a(f({open:!0,message:((p=o==null?void 0:o.data)==null?void 0:p.message)||"Failed to submit. Please try again later.",severity:"error"}))}};return t.jsxs(t.Fragment,{children:[t.jsx(g,{sx:s&&{...s},onClick:l,children:e}),t.jsxs(B,{open:i,onClose:n,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[t.jsx(L,{id:"alert-dialog-title",children:"Close ticket?"}),t.jsx(I,{children:t.jsx(W,{id:"alert-dialog-description",children:"Once you close your ticket, you won't be able to reopen it."})}),t.jsxs(U,{children:[t.jsx(g,{onClick:n,children:"Disagree"}),t.jsx(g,{disabled:C,onClick:b,autoFocus:!0,children:"Agree"})]})]})]})}const u=F(),q=[u.accessor("subject",{header:"Subject"}),u.accessor("status",{header:"Status"}),u.accessor("priority",{header:"Priority"}),u.accessor("createdAt",{header:"Date",Cell:({row:e})=>t.jsx(S,{children:new Date(e.original.createdAt).toLocaleString()})}),u.display({header:"Action",Cell:({row:e})=>{var a,i;const s=(a=e==null?void 0:e.original)==null?void 0:a._id;console.log(s);const r=((i=e==null?void 0:e.original)==null?void 0:i.status)!=="CLOSED";return t.jsxs(m,{sx:{flexDirection:"row",gap:"10px"},children:[t.jsx(g,{variant:"contained",component:z,to:"/dashboard/support/showTicket",state:{ticketId:s},size:"small",sx:{textTransform:"capitalize",boxShadow:"none",bgcolor:"primary.main",color:"white","&:hover":{boxShadow:"none"}},children:"View"}),r&&t.jsx(_,{ticketId:s,btnName:"Close",btnSx:{textTransform:"capitalize",boxShadow:"none",bgcolor:"primary.main",color:"white","&:hover":{boxShadow:"none"}}})]})},size:100})];function J(){var d,p,o;const[e,s]=x.useState({pageIndex:0,pageSize:10}),[r,a]=x.useState(""),{data:i,isLoading:c,isError:l,error:n}=A({page:e.pageIndex+1,sizePerPage:e.pageSize,status:r}),h=(d=n==null?void 0:n.data)==null?void 0:d.message,C=((p=i==null?void 0:i.data)==null?void 0:p.ticketList)||[],b=O({columns:q,data:C,enableColumnFilters:!1,enableSorting:!1,enableColumnActions:!1,manualPagination:!0,manualFiltering:!0,rowCount:((o=i==null?void 0:i.data)==null?void 0:o.totalRecords)||0,state:{pagination:e,isLoading:c,showAlertBanner:l},onPaginationChange:s,columnFilterDisplayMode:"popover",paginationDisplayMode:"pages",positionToolbarAlertBanner:"bottom",muiToolbarAlertBannerProps:l?{color:"error",children:h||"Error loading tickets."}:void 0});return t.jsxs(m,{sx:{mt:"30px"},children:[t.jsxs(m,{children:[t.jsx(E,{sx:{mb:.5,fontSize:12},children:"Status"}),t.jsx(H,{items:["OPEN","CLOSED","PROCESSING"],value:r,onChange:y=>a(y.target.value),width:{xs:"100%",sm:200}})]}),t.jsx(m,{sx:{marginTop:"2rem",borderRadius:"1.2rem",overflow:"hidden"},children:t.jsx(N,{table:b})})]})}function Ct(){return t.jsxs(m,{sx:{mt:"100px"},children:[t.jsx(S,{variant:"h5",fontWeight:"700",fontSize:"1.8rem",children:"My Tickets"}),t.jsx(J,{})]})}export{Ct as default};
