import{j as e,T as c,Q as d,S as x,B as h,a as f}from"./index-W3F8g-gH.js";import{c as u,u as b,M as w}from"./index.esm-E4WJbi0x.js";import{F as g,u as i,w as j}from"./xlsx-mpKnpTpg.js";import{C}from"./Container-C2chWd_a.js";import"./ExpandMore-B9Cn8QYi.js";import"./Search-FH8B6iNm.js";import"./Checkbox-p5JN4CZ-.js";import"./TableContainer-B81P4XN6.js";import"./Menu--OA5AKCf.js";import"./List-DDMEpOZM.js";import"./DatePicker-CAm8E7jF.js";import"./TextField-D75kfTsg.js";import"./Select-g_WXqCT7.js";import"./FormControl-D84P2tts.js";import"./ListItem-C7LD_4bU.js";import"./MenuItem-CtbLm0in.js";import"./listItemTextClasses-BkWN7RjR.js";import"./dividerClasses-DS1ge3n6.js";import"./KeyboardArrowRight-CgQCly0f.js";import"./ListItemIcon-D0qQFAu1.js";import"./TableRow-CSzPueZR.js";import"./Divider-BWvOf7AV.js";import"./Skeleton-BIz_sHQH.js";const a=u(),T=[a.accessor("name",{header:"Name",size:40}),a.accessor("level",{header:"Level",size:40}),a.accessor("referralCode",{header:"Referral Code",size:40}),a.accessor("date",{header:"Date",size:40,Cell:({row:o})=>e.jsx(c,{children:new Date(o.original.date).toLocaleString()})})],L=o=>{const t=i.json_to_sheet(o),r=i.book_new();i.book_append_sheet(r,t,"Sheet1"),j(r,"transactionList.xlsx")};function O(){var l;const{data:o,isLoading:t,isError:r,error:s}=d(),m=(l=s==null?void 0:s.data)==null?void 0:l.message,n=(o==null?void 0:o.data)||[],p=b({columns:T,data:n,enableColumnFilters:!1,enableSorting:!1,enableColumnActions:!1,state:{isLoading:t,showAlertBanner:r},columnFilterDisplayMode:"popover",enableGlobalFilter:!1,paginationDisplayMode:"pages",positionToolbarAlertBanner:"bottom",muiToolbarAlertBannerProps:r?{color:"error",children:m||"Error loading transactions."}:void 0,renderTopToolbarCustomActions:()=>e.jsx(h,{sx:{display:"flex",gap:2,padding:1,flexWrap:"wrap"},children:e.jsx(f,{variant:"contained",onClick:()=>L(n),startIcon:e.jsx(g,{sx:{color:"white"}}),sx:{textTransform:"none",color:"white",boxShadow:"none",bgcolor:"primary.main","&:hover":{boxShadow:"none"}},children:"Excel"})})});return e.jsxs(C,{sx:{mt:"100px"},children:[e.jsx(c,{variant:"h5",fontWeight:700,fontSize:"1.8rem",mb:4,children:"Referral List"}),e.jsx(x,{sx:{mt:4,borderRadius:2,overflow:"hidden"},children:e.jsx(w,{table:p})})]})}export{O as default};
