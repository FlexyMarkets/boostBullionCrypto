import{A as R,l as z,D as v,E as A,r as b,F as O,j as o,T as t,S as l,B as y,a as W,t as w}from"./index-BPKDHole.js";import{C as B}from"./Container-D4AUjQ6B.js";import{S as i}from"./Skeleton-DYZ3hU44.js";import{T as F}from"./TextField-B77SMJ87.js";import"./Select-5_MAovsi.js";import"./Menu-C5l8RJF2.js";import"./List-DH4347GI.js";import"./FormControl-R2PLJ0Ur.js";function G(){var j;const{state:p}=R(),u=p==null?void 0:p.ticketId;console.log(u);const m=z(),{data:h,isLoading:n}=v({id:u}),r=h==null?void 0:h.data,D={Subject:r==null?void 0:r.subject,Status:r==null?void 0:r.status,"Created on":r==null?void 0:r.createdAt,"Closed on":(r==null?void 0:r.status)==="CLOSED"?r==null?void 0:r.updatedAt:"Not closed yet"},{selectedTheme:x}=A(s=>s.themeMode),[c,g]=b.useState(""),[f,S]=b.useState(""),[C,{isLoading:L}]=O(),E=async s=>{var a,d;if(s.preventDefault(),!c.trim()){S("Reply message cannot be empty.");return}try{const e=await C({ticketId:u,message:c}).unwrap();e!=null&&e.status&&(S(""),m(w({open:!0,message:e==null?void 0:e.message,severity:"success"})),g(""))}catch(e){(a=e==null?void 0:e.data)!=null&&a.status||m(w({open:!0,message:((d=e==null?void 0:e.data)==null?void 0:d.message)||"Failed to submit. Please try again later.",severity:"error"}))}};return o.jsxs(B,{sx:{mt:"100px",display:"flex",flexDirection:"column",gap:"2rem"},children:[o.jsx(t,{variant:"h5",fontWeight:"700",fontSize:"1.8rem",children:"Show Ticket"}),o.jsx(l,{sx:{bgcolor:x==="dark"?"#272727":"#e9e6e6",p:"1rem",borderRadius:".5rem",gap:"5px"},children:Object.entries(D).map(([s,a],d)=>o.jsxs(y,{sx:{display:"flex",gap:".5rem"},children:[o.jsx(t,{fontSize:"1rem",fontWeight:"700",children:n?o.jsx(i,{width:"200px"}):`${s} :`}),o.jsx(t,{sx:{color:a==="CLOSED"?"red":a==="Open"&&"green",fontSize:"1rem",fontWeight:"700"},children:n?o.jsx(i,{width:"200px"}):s==="Created on"||(r==null?void 0:r.status)==="CLOSED"&&s==="Closed on"?new Date(a).toLocaleString():a})]},d))}),o.jsx(l,{sx:{bgcolor:x==="dark"?"#272727":"#e9e6e6",p:"1rem",borderRadius:".5rem",gap:"15px"},children:((j=r==null?void 0:r.message)==null?void 0:j.length)>0&&(r==null?void 0:r.message).map((s,a)=>o.jsx(l,{sx:{flexFlow:(s==null?void 0:s.sender)==="user"&&"row-reverse",textAlign:(s==null?void 0:s.sender)==="user"?"right":"left"},children:o.jsxs(y,{sx:{display:"flex",flexDirection:"column"},children:[o.jsx(t,{sx:{fontSize:"1rem",fontWeight:"bold"},children:n?o.jsx(i,{width:"200px"}):(s==null?void 0:s.sender)==="user"?"You":"Admin"}),o.jsx(t,{children:n?o.jsx(i,{width:"200px"}):s==null?void 0:s.text}),o.jsx(t,{sx:{fontSize:"12px"},children:n?o.jsx(i,{width:"200px"}):new Date(s==null?void 0:s.time).toLocaleString()})]})}))}),o.jsxs(l,{sx:{bgcolor:x==="dark"?"#272727":"#e9e6e6",p:"1rem",borderRadius:".5rem"},component:"form",onSubmit:E,children:[o.jsx(t,{mb:"1rem",fontSize:"1.2rem",fontWeight:"bold",color:x==="dark"?"#699d89":"#17433d",children:"Add reply"}),o.jsx(F,{name:"message",value:c,onChange:s=>g(s.target.value),multiline:!0,rows:3,placeholder:"Enter comment"}),f&&o.jsx(t,{color:"error",children:f}),o.jsx(W,{variant:"contained",disabled:L||(r==null?void 0:r.status)==="CLOSED"||n,type:"submit",sx:{textTransform:"capitalize",boxShadow:"none",bgcolor:"primary.main",color:"white",mt:"1.5rem",alignSelf:"flex-start","&:hover":{boxShadow:"none"}},children:"Submit"})]})]})}export{G as default};
